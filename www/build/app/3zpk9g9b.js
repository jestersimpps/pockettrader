/*! Built with http://stenciljs.com */
const{h:t}=window.App;import{b as e}from"./chunk-fa062d1d.js";import{a as i}from"./chunk-374e99fd.js";import"./chunk-6061a41c.js";import"./chunk-a7525511.js";var o;!function(t){t.limitbuy="limitbuy",t.limitsell="limitsell",t.marketbuy="marketbuy",t.marketsell="marketsell"}(o||(o={}));class n{constructor(){this.pairs=[],this.isLoading=!1,this.tradePrice=0,this.tradeAmount=0,this.tradeAction=o.limitbuy,this.baseBalance=0,this.quoteBalance=0}componentWillLoad(){this.store.mapStateToProps(this,t=>{const{app:{exchanges:e,baseCurrency:i,currencies:o,tickers:n,wallets:l}}=t;return{exchanges:e,baseCurrency:i,currencies:o,tickers:n,wallets:l}}),this.tickers.length&&(this.pairs=this.tickers[0].tickers.sort((t,e)=>{var i=t.symbol.toUpperCase(),o=e.symbol.toUpperCase();return i<o?-1:i>o?1:0}),this.exchangeId=this.tickers[0].exchangeId,this.getNewTicker(this.exchangeId,this.pairs[0].symbol))}exchangeSelected(t){this.exchangeId=t.target.value,this.pairs=this.tickers.find(e=>e.exchangeId===t.target.value).tickers.sort((t,e)=>{var i=t.symbol.toUpperCase(),o=e.symbol.toUpperCase();return i<o?-1:i>o?1:0}),this.getNewTicker(this.exchangeId,this.pairs[0].symbol)}pairSelected(t){this.getNewTicker(this.exchangeId,t.target.value)}getBalances(t,e){let i=this.exchanges.find(t=>t.id===this.exchangeId),o=i.balances.find(e=>e.symbol===t),n=i.balances.find(t=>t.symbol===e);this.quoteBalance=0,this.baseBalance=0,o&&(this.quoteBalance=o.available),n&&(this.baseBalance=n.available)}setPriceWithButtons(t){let e=this.tradePrice/100,i=this.tradePrice/1e3;switch(t){case"--":this.tradePrice-=e;break;case"-":this.tradePrice-=i;break;case"+":this.tradePrice+=i;break;case"++":this.tradePrice+=e}}getFormat(){let t=[];for(let e=0;e<this.ticker.info.precision.amount;e++)t.push("0");return`0,0.${t.join("")}`}getNewTicker(t,i){this.isLoading=!0,e.getTicker(t,i).then(t=>{this.ticker=t.data,this.tradePrice=+t.data.last,this.getBalances(t.data.quote,t.data.base),this.isLoading=!1})}setTradePrice(t){this.tradePrice=+t.target.value}setTradeAmount(t){this.tradeAmount=+t.target.value}setTradeAmountByButton(t){switch(this.tradeAction){case o.limitbuy:case o.marketbuy:this.tradeAmount=(this.quoteBalance*t-this.quoteBalance*t*this.ticker.info.taker)/this.tradePrice;break;case o.limitsell:case o.marketsell:this.tradeAmount=this.baseBalance*t-this.baseBalance*t*this.ticker.info.taker}}render(){return[t("ion-header",null,t("ion-toolbar",{color:"dark"},t("ion-buttons",{slot:"start"},t("ion-button",{fill:"solid",shape:"round",color:"danger",href:"/panic",padding:!0},t("ion-icon",{name:"alert"}),"Panic")),t("ion-title",{"text-center":!0},"Trade"))),t("ion-content",null,t("ion-list",null,t("ion-list-header",{color:"dark"},"Pair",this.ticker?t("ion-badge",{color:"light","margin-right":!0},this.exchangeId," - ",this.ticker.symbol):t("ion-icon",{name:"sync",class:"spin",slot:"end","margin-right":!0})),t("ion-item",{lines:"none"},t("ion-label",null,"Select Exchange"),t("select",{onChange:t=>this.exchangeSelected(t)},this.exchanges.filter(t=>t.key&&t.secret).map(e=>t("option",{value:e.id},e.id)))),t("ion-item",{lines:"none"},t("ion-label",null,"Select Pair"),t("select",{onChange:t=>this.pairSelected(t)},this.pairs.map(e=>t("option",{value:e.symbol},e.symbol)))),t("ion-list-header",{color:"dark"},"Price",this.isLoading?t("ion-icon",{name:"sync",class:"spin",slot:"end","margin-right":!0}):t("ion-badge",{color:"light","margin-right":!0},i(+this.tradePrice).format("0,0.00000000")," ",this.ticker.quote)),this.ticker&&t("div",null,t("ion-item",{lines:"none"},t("ion-label",null,"Last price"),t("ion-button",{color:"light",slot:"end","text-right":!0,onClick:()=>this.tradePrice=this.ticker.last},i(+this.ticker.last).format("0,0.00000000"))),t("ion-item",{lines:"none"},t("ion-label",null,"Set price"),t("ion-input",{name:"price",type:"number",value:`${this.tradePrice}`,onBlur:t=>this.setTradePrice(t)})),t("ion-grid",null,t("ion-row",null,t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setPriceWithButtons("--")},"- -")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setPriceWithButtons("-")},"-")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setPriceWithButtons("+")},"+")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setPriceWithButtons("++")},"+ +")))),t("ion-list-header",{color:"dark"},"Action",t("ion-badge",{color:"light","margin-right":!0},this.tradeAction)),t("ion-grid",null,t("ion-row",null,t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.tradeAction=o.marketbuy},"Market Buy")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.tradeAction=o.marketsell},"Market Sell"))),t("ion-row",null,t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.tradeAction=o.limitbuy},"Limit Buy")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.tradeAction=o.limitsell},"Limit Sell")))),t("ion-list-header",{color:"dark"},"Amount",this.isLoading?t("ion-icon",{name:"sync",class:"spin",slot:"end","margin-right":!0}):t("ion-badge",{color:"light","margin-right":!0},i(this.tradeAmount).format(this.getFormat())," ",(this.tradeAction===o.limitbuy||this.tradeAction===o.marketbuy)&&this.ticker.base,(this.tradeAction===o.limitsell||this.tradeAction===o.marketsell)&&this.ticker.quote)),t("ion-item",{lines:"none"},t("ion-label",null,"Available ",this.ticker.quote),t("ion-button",{color:"light",slot:"end","text-right":!0,onClick:()=>this.tradeAmount=this.quoteBalance/this.tradePrice},i(+this.quoteBalance).format("0,0.00000000"))),t("ion-item",{lines:"none"},t("ion-label",null,"Available ",this.ticker.base),t("ion-button",{color:"light",slot:"end","text-right":!0,onClick:()=>this.tradeAmount=this.baseBalance},i(+this.baseBalance).format("0,0.00000000"))),t("ion-item",{lines:"none"},t("ion-label",null,"Set Amount"),t("ion-input",{name:"price",type:"number",value:`${this.tradeAmount}`,onBlur:t=>this.setTradeAmount(t)})),t("ion-grid",null,t("ion-row",null,t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.1)},"10%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.2)},"20%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.3)},"30%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.4)},"40%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.5)},"50%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.6)},"60%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.7)},"70%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.8)},"80%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(.9)},"90%")),t("ion-col",null,t("ion-button",{expand:"block",color:"light",onClick:()=>this.setTradeAmountByButton(1)},"100%")))),t("ion-list-header",{color:"dark"},"Summary"),t("ion-item",{lines:"none"},t("ion-label",null,"Action"),t("ion-label",{slot:"end","text-right":!0},this.tradeAction)),t("ion-item",{lines:"none"},t("ion-label",null,"Amount"),t("ion-label",{slot:"end","text-right":!0},i(this.tradeAmount).format(this.getFormat())," ",this.ticker.base)),t("ion-item",{lines:"none"},t("ion-label",null,"Price"),t("ion-label",{slot:"end","text-right":!0},i(+this.tradePrice).format("0,0.00000000")," ",this.ticker.symbol)),t("ion-item",{lines:"none"},t("ion-label",null,"Fee"),t("ion-label",{slot:"end","text-right":!0},i(+this.ticker.info.taker*+this.tradeAmount*+this.tradePrice).format("0,0.00000000")," ",this.ticker.quote)),t("ion-item",{lines:"none"},t("ion-label",null,"Total"),t("ion-label",{slot:"end","text-right":!0},i(+this.tradeAmount*+this.tradePrice-+this.ticker.info.taker*+this.tradeAmount*+this.tradePrice).format("0,0.00000000")," ",this.ticker.quote)),t("ion-button",{expand:"block",color:"success",onClick:()=>this.executeOrder(this.ticker.symbol,this.tradeAction,this.tradePrice,this.tradeAmount)},"Execute"))))]}executeOrder(t,e,i,o){console.log(t,e,i,o)}static get is(){return"app-trade"}static get properties(){return{baseBalance:{state:!0},exchangeId:{state:!0},exchanges:{state:!0},isLoading:{state:!0},pairs:{state:!0},quoteBalance:{state:!0},store:{context:"store"},ticker:{state:!0},tickers:{state:!0},tradeAction:{state:!0},tradeAmount:{state:!0},tradePrice:{state:!0}}}static get style(){return".full{width:100%}"}}export{n as AppTrade};