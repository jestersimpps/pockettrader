/*! Built with http://stenciljs.com */
App.loadBundle("chunk-4c3efb41.js",["exports","./chunk-468533f7.js"],function(e,t){window;var n,r,o=function(){function e(){}return e.prototype.getTokenFromStorage=function(){return t.STORAGE.get("token")},e.prototype.setToken=function(e){return t.STORAGE.set("token",e)},e.prototype.generateNewToken=function(){var e=(new Date).getTime();return new Hashids("token-"+e,8).encode(1,2,3)},e}(),c=function(){function e(){}return e.prototype.getWalletsFromStorage=function(){return t.STORAGE.get("wallets")},e.prototype.setWallets=function(e){return t.STORAGE.set("wallets",e)},e.prototype.getCoinmarketCapListings=function(){return axios.get("https://api.coinmarketcap.com/v2/listings/")},e}();(n=e.OrderType||(e.OrderType={})).LIMITSELL="LIMITSELL",n.LIMITBUY="LIMITBUY",n.MARKETSELL="MARKETSELL",n.MARKETBUY="MARKETBUY",n.CANCEL="CANCEL",(r=e.OrderStatus||(e.OrderStatus={})).open="open",r.filled="filled",r.cancelled="cancelled",r.closed="closed",r.failed="failed";var a=function(){function e(){}return e.prototype.getOrdersFromStorage=function(){return t.STORAGE.get("orders")},e.prototype.setOrders=function(e){return t.STORAGE.set("orders",e)},e.prototype.newOrder=function(e,t){return axios.post("https://lightningassets.com/exchangeapi/"+e.id+"/orders/create",t)},e.prototype.getOrder=function(e,t,n){return axios.post("https://lightningassets.com/exchangeapi/"+e.id+"/orders/get",{pair:n,orderId:t,clientCreds:{key:e.key,secret:e.secret}})},e.prototype.cancelOrder=function(e,t,n){return axios.post("https://lightningassets.com/exchangeapi/"+e.id+"/orders/cancel",{pair:n,orderId:t,clientCreds:{key:e.key,secret:e.secret}})},e.prototype.getOhlc=function(e,t,n){return void 0===n&&(n="1h"),axios.get("https://lightningassets.com/exchangeapi/"+e+"/ticker/ohlc?symbol="+t+"&timeframe="+n)},e}(),i=function(){function n(){}return n.prototype.getTotalBalancesFromStorage=function(){return t.STORAGE.get("totalbalances")},n.prototype.getBalancesFromStorage=function(){return t.STORAGE.get("balances")},n.prototype.getLatestTotal=function(e){return e.length?e[e.length-1][1]:0},n.prototype.setTotalBalances=function(e){t.STORAGE.set("totalbalances",e)},n.prototype.setBalances=function(e){t.STORAGE.set("balances",e)},n.prototype.getBalances=function(e){return axios.post("https://lightningassets.com/exchangeapi/"+e.id+"/balances/get",{key:e.key,secret:e.secret})},n.prototype.refreshBalances=function(t,n,r,o){var c=this,a=[],i=[],s=[],u=[],f=[],d=t.filter(function(e){return e.balance>0}),h=n.filter(function(e){return e.key&&e.secret});h.forEach(function(e){a.push(e.id),i.push(g.getTickers(e.id)),s.push(p.getBalances(e))}),d.forEach(function(e){return u.push(g.getCoinmarketcapTicker(e.id))});var y={conversionrates:null,tickers:null,wallets:null,orders:null,exchanges:null,exchangeTotal:0,walletTotal:0};return l.getConversionRates().then(function(t){return y.conversionrates=t,Promise.all(i).then(function(t){return Promise.all(u).then(function(i){return Promise.all(s).then(function(s){for(var u=function(e){f[e]={exchangeId:a[e],tickers:t[e].data},h[e].balances=s[e].data.map(function(n){var r=c.getBtcStats(n,t[e].data);return y.exchangeTotal+=r.amount,{btcAmount:r.amount,balance:n.balance,pending:n.pending,available:n.available,currency:n.currency,btcPrice:r.price,change:r.change}}).filter(function(e){return+e.btcAmount>o})},l=0;l<a.length;l++)u(l);for(r.filter(function(t){return t.status!=e.OrderStatus.cancelled}).map(function(e){var t=f.find(function(t){return t.exchangeId===e.exchangeId}).tickers.find(function(t){return t.symbol===e.pair});return e.last=t.last,console.log(e),e}),l=0;l<d.length;l++)d[l].btcPrice=+i[l].data.data.quotes.BTC.price,d[l].btcAmount=+d[l].balance*+i[l].data.data.quotes.BTC.price,d[l].change=+i[l].data.data.quotes.BTC.percent_change_24h,y.walletTotal+=+d[l].balance*+i[l].data.data.quotes.BTC.price;return y.tickers=f,y.orders=r.filter(function(e){return e.orderId}),y.wallets=d,y.exchanges=n.map(function(e){return h.find(function(t){return t.id===e.id})||e}),y}).catch(function(){return window.alert("Error fetching balance data, please check API keys"),null})}).catch(function(){return window.alert("Error fetching wallet data, please check internet connection"),null})}).catch(function(){return window.alert("Error fetching ticker data, please check internet connection"),null})}).catch(function(){return window.alert("Error fetching conversionrates, please check internet connection"),null})},n.prototype.getBtcStats=function(e,t){var n={price:0,amount:0,change:0,last:0,symbol:null},r=t.find(function(t){return t.symbol===e.currency+"/BTC"}),o=t.find(function(t){return t.symbol==="BTC/"+e.currency});return"BTC"===e.currency&&(n.amount=e.balance,n.price=1),r&&(n.amount=e.balance*r.last,n.price=r.last,n.change=r.percentage,n.symbol=r.symbol),o&&(n.amount=e.balance/o.last,n.price=1/o.last,n.change=o.percentage,n.symbol=o.symbol),n},n}(),s=function(){function e(){this.currencies=[{id:"mBTC",symbol:"mBTC",conversionRate:1e3},{id:"BTC",symbol:"BTC",conversionRate:1},{id:"EUR",symbol:"€",conversionRate:null},{id:"USD",symbol:"$",conversionRate:null},{id:"GBP",symbol:"£",conversionRate:null}]}return e.prototype.getBaseCurrencyFromStorage=function(){return t.STORAGE.get("basecurrency")},e.prototype.getConversionRates=function(){var e=this;return axios.get("https://api.coindesk.com/v1/bpi/currentprice.json").then(function(n){return e.currencies.map(function(e){switch(e.id){case"USD":e.conversionRate=+n.data.bpi.USD.rate_float;break;case"EUR":e.conversionRate=+n.data.bpi.EUR.rate_float;break;case"GBP":e.conversionRate=+n.data.bpi.GBP.rate_float}}),t.STORAGE.set("currencies",e.currencies),e.currencies})},e.prototype.setBaseCurrency=function(e){t.STORAGE.set("basecurrency",e)},e.prototype.convertToBase=function(e,t){return e*this.currencies.find(function(e){return e.id===t.id}).conversionRate},e.prototype.getBaseTotal=function(e,t){var n=0;return e.forEach(function(e){n+=e.btcAmount}),this.convertToBase(n,t)},e}(),u=function(){function e(){}return e.prototype.getTickersFromStorage=function(){return t.STORAGE.get("tickers")},e.prototype.setTickers=function(e){return t.STORAGE.set("tickers",e)},e.prototype.getTickers=function(e){return axios.get("https://lightningassets.com/exchangeapi/"+e+"/tickers")},e.prototype.getTicker=function(e,t){return axios.get("https://lightningassets.com/exchangeapi/"+e+"/ticker/data?symbol="+t)},e.prototype.getCoinmarketcapTicker=function(e){return axios.get("https://api.coinmarketcap.com/v2/ticker/"+e+"/?convert=BTC")},e}(),l=new s,p=new i,f=new t.ExchangeService,g=new u,d=new c,h=new o,y=new a;e.CURRENCYSERVICE=l,e.TICKERSERVICE=g,e.BALANCESERVICE=p,e.TRADESERVICE=y,e.WALLETSERVICE=d,e.TOKENSERVICE=h,e.EXCHANGESERVICE=f});