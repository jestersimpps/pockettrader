/*! Built with http://stenciljs.com */
App.loadBundle("refoxkdz",["exports","./chunk-4c3efb41.js","./chunk-50c69dbd.js","./chunk-d636877a.js","./chunk-b5724922.js","./chunk-468533f7.js"],function(e,t,n,a,r,c){var i=window.App.h,o=function(){function e(){this.exchanges=[],this.isLoading=!1}return e.prototype.componentWillLoad=function(){this.store.mapStateToProps(this,function(e){var t=e.app;return{exchanges:t.exchanges,baseCurrency:t.baseCurrency,currencies:t.currencies,tickers:t.tickers,wallets:t.wallets,balances:t.balances,orders:t.orders,dust:t.dust}}),this.store.mapDispatchToProps(this,{appSetExchanges:n.appSetExchanges,appSetBaseCurrency:n.appSetBaseCurrency,appSetCurrencies:n.appSetCurrencies,appSetTickers:n.appSetTickers,appSetTotalBalances:n.appSetTotalBalances,appSetWallets:n.appSetWallets,appSetBalances:n.appSetBalances,appSetOrders:n.appSetOrders});var e=this.wallets.filter(function(e){return e.balance>0}),t=this.exchanges.filter(function(e){return e.key&&e.secret});this.showTutorial=e.length+t.length===0},e.prototype.addTotalBalance=function(e){var n=this;t.BALANCESERVICE.getTotalBalancesFromStorage().then(function(a){if(e&&e>0){var r=Math.round((new Date).getTime());t.BALANCESERVICE.setTotalBalances(a.concat([[r,e]])),n.appSetTotalBalances(a.concat([[r,e]]))}})},e.prototype.getBtcStats=function(e,t){var n={price:0,balance:0,change:0},a=t.find(function(t){return t.symbol===e.currency+"/BTC"});return"BTC"===e.symbol&&(n.balance=e.balance,n.price=1),a&&(n.balance=e.balance*a.last,n.price=a.last,n.change=a.percentage),n},e.prototype.refreshBalances=function(){var e=this;this.isLoading=!0,t.BALANCESERVICE.refreshBalances(this.wallets,this.exchanges,this.orders,this.dust).then(function(t){t&&(e.appSetCurrencies(t.conversionrates),e.appSetTickers(t.tickers),e.appSetWallets(t.wallets),e.appSetExchanges(t.exchanges),e.addTotalBalance(t.exchangeTotal+t.walletTotal),e.appSetBalances({overview:t.exchangeTotal+t.walletTotal,exchanges:t.exchangeTotal,wallets:t.walletTotal}),e.appSetOrders(t.orders)),e.isLoading=!1})},e.prototype.render=function(){var e=this;return[i("ion-header",null,i("ion-toolbar",{color:"dark"},i("ion-buttons",{slot:"start"},i("ion-button",{"icon-only":!0,href:"/settings",padding:!0},i("ion-icon",{name:"options"}))),i("ion-title",{"text-center":!0},i("ion-badge",{color:"light"},i("app-baseprice",{btcPrice:t.CURRENCYSERVICE.convertToBase(this.balances.overview,this.baseCurrency),baseCurrency:this.baseCurrency}))),i("ion-buttons",{slot:"end"},i("ion-button",{"icon-only":!0,disabled:this.isLoading,onClick:function(){return e.refreshBalances()},padding:!0},i("ion-icon",{name:"refresh",class:this.isLoading?"spin":""}))))),i("ion-content",null,this.isLoading?i("div",{class:"progress","text-center":!0},i("ion-icon",{name:"sync",class:"spin"})):this.showTutorial?[i("div",null,i("p",null,"Welcome to Pocket Trader!"),i("ion-button",{expand:"block",color:"light",href:"/settings/tutorial"},"View tutorial"))]:i("ion-list",null,i("ion-list-header",{color:"light"},"Distribution & 24h Change"),i("app-sunburst",{exchanges:this.exchanges,wallets:this.wallets,totalBalance:this.balances.overview,baseCurrency:this.baseCurrency}),i("ion-list-header",{color:"light"},"Total Balance (",this.baseCurrency.id,")"),i("app-splinechart",null)))]},Object.defineProperty(e,"is",{get:function(){return"app-overview"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{balances:{state:!0},baseCurrency:{state:!0},dust:{state:!0},exchanges:{state:!0},isLoading:{state:!0},orders:{state:!0},showTutorial:{state:!0},store:{context:"store"},tickers:{state:!0},wallets:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return""},enumerable:!0,configurable:!0}),e}(),s=function(){function e(){}return e.prototype.componentWillLoad=function(){this.store.mapStateToProps(this,function(e){var t=e.app;return{baseCurrency:t.baseCurrency,totalBalances:t.totalBalances}})},e.prototype.componentDidLoad=function(){this.chart=a.highstock.stockChart("spline",{title:{text:""},rangeSelector:{inputEnabled:!1,selected:2,buttons:[{type:"minute",count:60,text:"1h"},{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}]},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%e. %b",year:"%b"},title:{text:""}},yAxis:{title:{text:"Balance ("+this.baseCurrency.symbol+")"}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"<b>Time:</b> {point.x:%e %b %Y, %H:%M}<br><b>Balance:</b> "+this.baseCurrency.symbol+" {point.y:.8f} "},plotOptions:{spline:{marker:{enabled:!0,radius:2}}},legend:{enabled:!1},colors:["#000"],series:[{name:"Total "+this.baseCurrency.id+" Balance over time",data:this.balancePoints()}]})},e.prototype.balancePoints=function(){var e=this,n=[];return this.totalBalances.forEach(function(a){n.push([a[0],+t.CURRENCYSERVICE.convertToBase(a[1],e.baseCurrency)])}),n},e.prototype.render=function(){return[i("div",{id:"spline",class:"chart"})]},Object.defineProperty(e,"is",{get:function(){return"app-splinechart"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{baseCurrency:{state:!0},store:{context:"store"},totalBalances:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".chart{height:400px}"},enumerable:!0,configurable:!0}),e}(),l=function(){function e(){this.exchanges=[],this.wallets=[]}return e.prototype.componentDidLoad=function(){var e={name:this.baseCurrency.symbol+" "+r.numeral(t.CURRENCYSERVICE.convertToBase(this.totalBalance,this.baseCurrency)).format("BTC"===this.baseCurrency.id?"0,0.0000":"0,0.00"),change:0,children:this.exchanges.map(function(e){return{name:e.id,balance:e.balances.reduce(function(e,t){return e+t.balance},0),value:e.balances.reduce(function(e,t){return e+t.btcAmount},0),change:e.balances.reduce(function(e,t){return e+t.change*t.btcAmount},0)/e.balances.reduce(function(e,t){return e+t.btcAmount},0),children:e.balances.map(function(e){return{name:e.currency,size:e.btcAmount,balance:e.balance,value:e.btcAmount,change:e.change}})}}).concat([{name:"Wallets",balance:this.wallets.reduce(function(e,t){return e+t.balance},0),value:this.wallets.reduce(function(e,t){return e+t.btcAmount},0),change:this.wallets.reduce(function(e,t){return e+t.change*t.btcAmount},0)/this.wallets.reduce(function(e,t){return e+t.btcAmount},0),children:this.wallets.map(function(e){return{name:e.currency,size:e.btcAmount,balance:e.balance,value:e.btcAmount,change:e.change}})}])},n=window.innerWidth,a=window.innerHeight,c=Math.min(n,a)/1.4,i=Math.max.apply(Math,this.exchanges.map(function(e){return Math.max.apply(Math,e.balances.map(function(e){return e.change}))})),o=Math.min.apply(Math,this.exchanges.map(function(e){return Math.min.apply(Math,e.balances.map(function(e){return e.change}))})),s=d3.scaleLinear().domain([o,0,i]).range(["#f53d3d","#fff","#10dc60"]),l=d3.scaleLinear().range([0,2*Math.PI]).clamp(!0),u=d3.scaleLinear().range([.1*c,c]),p=d3.partition(),h=function(e){var t=Math.PI/2,n=[l(e.x0)-t,l(e.x1)-t],a=Math.max(0,(u(e.y0)+u(e.y1))/2),r=(n[1]+n[0])/2,c=r>0&&r<Math.PI;c&&n.reverse();var i=d3.path();return i.arc(0,0,a,n[0],n[1],c),i.toString()},d=function(e){var t=l(e.x1)-l(e.x0),n=Math.max(0,(u(e.y0)+u(e.y1))/2);return 6*e.data.name.length<n*t},b=d3.select("#sunburst-chart").append("svg").style("width","100vw").style("height","400px").style("background","#fff").attr("viewBox",-n/2+" "+-a/2+" "+n+" "+a).on("click",function(){return m()}),f=d3.hierarchy(e).sum(function(e){return e.size}),y=b.selectAll("g.slice").data(p(f).descendants()).enter().append("g").attr("class","slice").on("click",function(e){d3.event.stopPropagation(),m(e)}),g=d3.arc().startAngle(function(e){return l(e.x0)}).endAngle(function(e){return l(e.x1)}).innerRadius(function(e){return Math.max(0,u(e.y0))}).outerRadius(function(e){return Math.max(0,u(e.y1))});function m(e){void 0===e&&(e={x0:0,x1:1,y0:0,y1:1});var t=b.transition().duration(500).tween("scale",function(){var t=d3.interpolate(l.domain(),[e.x0,e.x1]),n=d3.interpolate(u.domain(),[e.y0,1]);return function(e){l.domain(t(e)),u.domain(n(e))}});t.selectAll("path.main-arc").attrTween("d",function(e){return function(){return g(e)}}),t.selectAll("path.hidden-arc").attrTween("d",function(e){return function(){return h(e)}}),t.selectAll("text").attrTween("display",function(e){return function(){return d(e)?null:"none"}}),function e(t){b.selectAll(".slice").filter(function(e){return e===t}).each(function(t){this.parentNode.appendChild(this),t.parent&&e(t.parent)}).transition().duration(500)}(e)}y.append("path").attr("class","main-arc").attr("fill",function(e){return s(e.data.change)}).transition().duration(function(e){return 2e3*(e.y1-e.y0)}).attrTween("d",function(e){var t=d3.interpolate(e.x0,e.x1);return function(n){return e.x1=t(n),g(e)}}),y.append("path").attr("class","hidden-arc").attr("id",function(e,t){return"hiddenArc"+t}).attr("d",h),y.append("text").style("stroke","#000").attr("fill","#000").style("font-size","1.2rem").append("textPath").attr("startOffset","50%").attr("xlink:href",function(e,t){return"#hiddenArc"+t}).text(function(e){return 0!=e.data.change?e.data.name+" ("+r.numeral(e.data.change).format("0.0")+"%)":""})},e.prototype.render=function(){return[i("div",{id:"sunburst-chart"})]},Object.defineProperty(e,"is",{get:function(){return"app-sunburst"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{baseCurrency:{type:"Any",attr:"base-currency"},exchanges:{type:"Any",attr:"exchanges"},totalBalance:{type:Number,attr:"total-balance"},wallets:{type:"Any",attr:"wallets"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".slice{cursor:pointer}.slice .main-arc{stroke:#fff;stroke-width:5px}.slice .hidden-arc{fill:none}.slice text{pointer-events:none;text-anchor:middle}"},enumerable:!0,configurable:!0}),e}();e.AppOverview=o,e.AppSplinechart=s,e.AppSunburst=l,Object.defineProperty(e,"__esModule",{value:!0})});